#include <stdint.h>
#include <stdio.h>
#include <string.h>
#include "params.h"
#include "kem.h"
#include "poly.h"

#define NTESTS 1

void test_kem()
{
  unsigned int i, j;
  unsigned char k1[FPTRU_SHAREDKEYBYTES], k2[FPTRU_SHAREDKEYBYTES];
  unsigned char pk[FPTRU_KEM_PUBLICKEYBYTES]={0x41,0x9f,0x77,0x7f,0xdb,0xb7,0x2d,0xbd,0xbe,0x25,0x27,0x5f,0x99,0x83,0x7a,0x76,0xee,0xf7,0x16,0x9e,0x20,0x76,0x98,0xb1,0xba,0xf8,0xe2,0x63,0x78,0xdf,0xd1,0x49,0x49,0x40,0x98,0x95,0xac,0x31,0xa2,0x99,0x2,0x39,0xb4,0xbd,0xe7,0xde,0x65,0xb1,0xfc,0xc,0x65,0x6b,0x1e,0xc7,0x1e,0x9b,0x75,0xf6,0x35,0x7,0x5e,0x1c,0xb4,0x83,0x37,0x61,0x3b,0xbc,0x4a,0x48,0xd7,0x98,0xd4,0xdb,0x18,0x30,0x6f,0x3d,0xec,0xb9,0xb3,0xde,0xc3,0xc7,0x86,0x28,0x70,0x4f,0x24,0xa7,0x8c,0x79,0xc6,0x16,0x58,0xe6,0xec,0xa8,0xb7,0xd7,0x68,0xf0,0x21,0xac,0x9a,0xee,0x33,0x64,0xa9,0x3b,0xfb,0x28,0xf8,0x3a,0x1f,0x99,0x99,0x7a,0x90,0x9f,0xe6,0x77,0x30,0x53,0x32,0xb5,0xcd,0xda,0xed,0x33,0x93,0x8,0x92,0x3b,0x9b,0xd3,0x21,0x7f,0x73,0x70,0xbf,0x9d,0x52,0x6a,0x47,0x3f,0xd8,0xf5,0x94,0x15,0x11,0x4,0x30,0xbe,0xc0,0x7,0xa6,0xec,0xeb,0x22,0x84,0x50,0xfc,0xe5,0x64,0x5c,0x28,0xb8,0xb5,0x57,0x36,0x3c,0x4b,0xaf,0xff,0x4f,0x90,0x93,0x72,0x7a,0xc3,0xa,0x30,0x91,0xd1,0x18,0x1,0xfb,0x9d,0x9f,0x26,0x41,0x50,0x2a,0x9e,0xc5,0xb8,0x35,0x3b,0x73,0xd5,0x2c,0xef,0x65,0x66,0x91,0xcc,0x6e,0x59,0xe2,0xc7,0x41,0xe0,0x57,0x77,0x66,0xa5,0x48,0x64,0xd3,0xd9,0xa3,0x7e,0xe,0x33,0x82,0x4f,0xcd,0x98,0xe5,0xea,0x39,0xdb,0x9,0xe2,0x1f,0x8a,0x53,0xcb,0xf6,0xee,0xfa,0x4d,0xdc,0x5f,0xd8,0xb6,0xa5,0x7,0xf7,0x37,0x2d,0x50,0x3b,0x8f,0xca,0x58,0x57,0x40,0x49,0x84,0xe6,0x5,0xaa,0xde,0xd5,0xf9,0x61,0xaf,0x79,0xd2,0xdb,0xcb,0xe5,0x7d,0x86,0x6,0xa0,0xb9,0xa6,0x9c,0xe3,0xcc,0x3e,0x37,0xba,0x55,0xad,0xc0,0x6a,0x47,0x72,0x8,0x87,0xa7,0xf5,0xcd,0xd4,0x9c,0x20,0x62,0xda,0x98,0x9c,0x13,0x15,0x93,0x32,0xd0,0x15,0x3d,0xcf,0xbf,0x6a,0x9d,0x94,0x7e,0x2d,0xcd,0xec,0xe3,0xec,0x88,0x7d,0x2e,0xee,0x4b,0xb5,0x6f,0xe3,0x91,0xab,0xa8,0xdb,0xf8,0x6d,0x8b,0x6a,0x5,0x7a,0x77,0xa3,0xc7,0x69,0xc3,0xce,0xcc,0x1f,0xa8,0x10,0x7c,0x95,0xc8,0x23,0x33,0xaa,0x1d,0x66,0x2c,0x30,0x37,0xf6,0x29,0x7f,0xf2,0xa5,0x2f,0xbf,0xc,0x4e,0xb1,0x38,0x4,0x18,0x79,0xa5,0x67,0x42,0xb3,0xf8,0xdd,0xa3,0x43,0xdb,0x34,0xde,0x3,0xe1,0x8e,0xb2,0xe1,0x6b,0xcf,0xdc,0x79,0xd0,0x63,0x1f,0x12,0xd7,0x77,0x85,0x1e,0xf,0xcb,0xa0,0x33,0x4b,0xea,0x3c,0xe,0x7e,0x68,0xff,0x76,0xc7,0x49,0x2c,0x57,0x8,0x56,0x72,0x1d,0xc0,0x41,0x72,0x91,0x75,0x84,0xe8,0xf1,0x7b,0xf9,0xbb,0x7b,0x7a,0xab,0x5f,0x83,0x8f,0x88,0x91,0x2f,0x50,0x59,0x8,0xaa,0x9d,0x7e,0x4f,0x8e,0x24,0x4b,0xde,0x3e,0x76,0x7c,0x91,0x9,0x11,0x2d,0x6c,0xbf,0x2d,0xdf,0x8a,0x5b,0xe8,0x85,0x83,0x55,0x3,0x9d,0xe9,0x39,0x53,0x8b,0xeb,0x19,0x54,0x79,0x23,0x2a,0x61,0x32,0x74,0x6b,0x35,0xb7,0xda,0xf8,0xc7,0x14,0xac,0xb9,0x4a,0x54,0xd2,0x1a,0x47,0x23,0x1,0xe,0xf5,0xa5,0xf1,0x2,0x70,0xa2,0xb3,0x6c,0x72,0x25,0x29,0x2d,0xe2,0xdf,0x78,0xa0,0x4e,0x5e,0x5b,0x8b,0xb0,0xb9,0xb2,0xff,0xb8,0xbe,0x17,0xca,0x23,0xda,0xad,0xe2,0x72,0xd4,0x6b,0x9e,0x90,0xf7,0x36,0xe6,0xcb,0x58,0x43,0x71,0xf1,0x54,0x4a,0x66,0x22,0x29,0x93,0x56,0x7b,0x59,0x33,0xd4,0x62,0x77,0x2b,0xa4,0x90,0xbf,0x55,0xdf,0x5e,0xe1,0xd8,0x5d,0xb0,0x37,0xf2,0x65,0xe6,0xac,0x3b,0x44,0x56,0xec,0x8f,0xa1,0x3f,0x32,0x7f,0xd3,0x6f,0xc3,0x76,0x1b,0x76,0x62,0x53,0xde,0x82,0xff,0xee,0xc8,0xc6,0x29,0x2a,0xdb,0xa1,0x1f,0x27,0xd6,0x99,0x4a,0x81,0x2c,0xcc,0x5c,0x16,0x90,0xec,0x30,0xc1,0x8d,0xb2,0xaa,0xd8,0x1c,0x43,0xd3,0xcf,0xe1,0x1d,0xdb,0xf4,0x33,0x82,0xcf,0x98,0x20,0xce,0xba,0x5f,0x88,0xc4,0xa,0x2,0x94,0xb5,0x42,0xd9,0xa9,0xd9,0xe8,0xaf,0x7e,0x73,0xd5,0x9e,0xc5,0x7b,0x28,0x27,0xfb,0xe9,0xb3,0x5b,0x57,0xca,0xb2,0x2b,0xf3,0x6b,0x95,0xf0,0xae,0x8e,0x6b,0x7f,0xde,0x8e,0x8f,0x5a,0xb6,0xae,0xd1,0xc8,0x9e,0x0,0xb7,0xc4,0x10,0x63,0xf9,0x3e,0x2e,0x6,0x7c,0xc8,0xe4,0xaf,0xc2,0xa9,0x71,0xf3,0x76,0x55,0x6d,0xdd,0x6e,0xd8,0x9e,0x12,0xd9,0xc1,0x7c,0xc4,0x2b,0xe4,0xb3,0xbc,0xa,0xe,0x7c,0x24,0x1,0xaf,0xfa,0xe7,0xb8,0xd2,0x50,0x8d,0x91,0x2a,0x8,0x65,0x2c,0x54,0xd2,0xc6,0x1d,0xe6,0x99,0xa2,0xf6,0x79,0xbf,0x86,0x55,0x90,0xb4,0x35,0x7e,0xa6,0xc,0xeb,0x2b,0x9b,0x8c,0x56,0xaa,0x79,0x6f,0xce,0x37,0x32,0x58,0x24,0x6b,0x95,0xae,0xae,0x5e,0x87,0xec,0x5f,0x88,0x32,0x75,0x15,0x11,0x82,0xe5,0xad,0x3a,0x1d,0xc7,0x73,0xc8,0xaf,0x74,0x9a,0x54,0x68,0x49,0x79,0xab,0x4d,0xa1,0xe8,0xe8,0xf2,0xe8,0xdd,0x95,0x8e,0x74,0xb,0x87,0xbf,0xe9,0x17,0x44,0x4c,0xf6,0xd8,0x82,0xa1,0x56,0x5e,0x5f,0x95,0x3f,0x39,0x71,0xe2,0xbc,0x37,0xcd,0xad,0x4,0xa9,0xe9,0xaf,0x8f,0x2a,0xc7,0x91,0xd1,0x57,0x42,0xb0,0xbf,0x40,0x9f,0x60,0xed,0x7a,0x4e,0x4a,0x34,0x90,0xf4,0x17,0x12,0x26,0xd4,0xbf,0x90,0x18,0xf8,0xf2,0x70,0x39,0xcc,0xbc,0x6b,0x37,0xc5,0xaa,0x5,0xbf,0x9f,0x8e,0xd8,0xc6,0xe8,0xfe,0x7a,0x83,0x92,0x3a,0xbe,0x5a,0x42,0xf1,0xdd,0xea,0xac,0x5f,0xe5,0x58,0x33,0x7f,0x91,0xf2,0x17,0x4,0xa3,0x94,0xea,0xc9,0xbe,0x4a,0xe2,0x55,0xca,0xa7,0x91,0xf,0x4e,0x90,0x9c,0xba,0xa5,0x97,0x9e,0xb3,0xf5,0x8b,0x5b,0x71,0xed,0x97,0xd0,0x2e,0x7b,0x55,0xa3,0x42,0xf6,0x49,0x38,0xf5,0x45,0xf0,0x44,0x30,0x2d,0xb6,0x27,0xfe,0x33,0x7a,0x6e,0x92,0x90,0xbc,0xad,0x18,0xb5,0xda,0x5f,0x1f,0x51,0x92,0x3c,0xbe,0xfa,0x2f,0x3b,0xc2,0x8,0x38,0xc4,0xa8,0xd7,0x5,0xb0,0x31,0xeb,0x8c,0xbc,0xea,0x38,0xcf,0xda,0x30,0xc1,0xbf,0xbd,0x3f,0xe1,0x15,0xb6,0xff,0x52,0x78,0x82,0xce,0xde,0x49,0x3a,0xb5,0x7a,0x6f,0x14,0x8b,0x7a,0xff,0x69,0xf2,0xef,0x8d,0x3c,0x37,0x78,0x36,0x94,0xa8,0xd1,0xc0,0xd,0x87,0x90,0x88,0x74,0x74,0xb2,0xc2,0x3,0x29,0xb2,0x90,0x4c,0x91,0xea,0xf,0xd5,0xa3,0xd3,0x7c,0x53,0x9,0x69,0xb6,0xcb,0xdf,0xd9,0x7,0x34,0x95,0xa8,0xd1,0x25,0x2f,0x28,0xcb,0xb4,0xbc,0x9,0xea,0x9b,0xe8,0x65,0x37,0x7,0xb5,0xf0,0x80,0x16,0xf0,0xa0,0xa6,0xa5,0x1d,0x73,0xd8,0xe5,0xef,0x89,0xf,0x79,0xc7,0x7e,0x36,0xf7,0x8a,0x8a,0xc2,0xef,0x7a,0x23,0xfd,0xcb,0x87,0x1d,0x78,0x52,0xb5,0x5e,0xf7,0x86,0x47,0xc8,0xcb,0x1,0x58,0xa6,0xb2,0x8d,0x94,0x79,0x60,0xe,0xe0,0xe7,0x5e,0x1c,0xdb,0x16,0xb2,0x5c,0x98,0x97,0x33,0x73,0x91,0xc0,0xa,0xce,0xb5,0x94,0x8f,0x99,0x9c,0x5e,0x26,0xba,0xbd,0x68,0xa0,0xb0,0x6f,0x8b,0x2a,0x4f,0x8c,0x45,0xa9,0xa8,0xbc,0x55,0xf6,0xbb,0x95,0xbf,0x2e,0xc0,0x8b,0x6,0xc,0x80,0xa0,0x42,0xaa,0x41,0x5f,0x8d,0x22,0xee,0x1,};
  unsigned char sk[FPTRU_KEM_SECRETKEYBYTES]={0x54,0x57,0x77,0x35,0x55,0x53,0x59,0x93,0x55,0x13,0x53,0x57,0x35,0x35,0x55,0x53,0x97,0x35,0x57,0x53,0x55,0x95,0x57,0x15,0x55,0x15,0x35,0x55,0x35,0x95,0x77,0x35,0x13,0x75,0x79,0x99,0x35,0x73,0x77,0x79,0x77,0x19,0x57,0x55,0x95,0x73,0x75,0x55,0x33,0x75,0x79,0x35,0x95,0x95,0x55,0x55,0x55,0x75,0x17,0x35,0x15,0x35,0x57,0x57,0x39,0x53,0x73,0x33,0x33,0x53,0x77,0x55,0x79,0x79,0x77,0x93,0x75,0x31,0x11,0x73,0x93,0x57,0x51,0x77,0x77,0x35,0x97,0x37,0x57,0x73,0x99,0x57,0x75,0x55,0x33,0x35,0x73,0x59,0x35,0x93,0x33,0x77,0x55,0x37,0x13,0x35,0x59,0x53,0x13,0x59,0x75,0x15,0x75,0x93,0x53,0x39,0x91,0x31,0x79,0x55,0x77,0x35,0x37,0x35,0x53,0x35,0x73,0x17,0x73,0x57,0x33,0x13,0x33,0x13,0x37,0x75,0x57,0x31,0x53,0x75,0x55,0x39,0x59,0x35,0x55,0x35,0x33,0x59,0x33,0x37,0x75,0x53,0x55,0x71,0x35,0x77,0x77,0x55,0x97,0x77,0x57,0x51,0x73,0x75,0x73,0x33,0x53,0x55,0x37,0x93,0x35,0x53,0x75,0x53,0x73,0x57,0x37,0x33,0x55,0x75,0x77,0x71,0x57,0x77,0x93,0x13,0x75,0x55,0x93,0x55,0x77,0x35,0x57,0x71,0x53,0x57,0x77,0x53,0x79,0x35,0x75,0x75,0x53,0x55,0x37,0x55,0x97,0x53,0x35,0x71,0x53,0x71,0x57,0x55,0x57,0x73,0x35,0x71,0x77,0x31,0x53,0x79,0x91,0x57,0x51,0x55,0x33,0x55,0x55,0x37,0x53,0x55,0x73,0x37,0x77,0x31,0x73,0x55,0x35,0x95,0x35,0x35,0x53,0x77,0x55,0x57,0x53,0x53,0x53,0x35,0x37,0x55,0x75,0x55,0x91,0x71,0x95,0x71,0x35,0x79,0x33,0x55,0x79,0x75,0x35,0x17,0x55,0x33,0x75,0x59,0x93,0x33,0x77,0x51,0x97,0x37,0x17,0x53,0x55,0x33,0x33,0x57,0x53,0x57,0x37,0x75,0x75,0x73,0x75,0x33,0x35,0x55,0x33,0x17,0x95,0x35,0x55,0x77,0x75,0x73,0x75,0x53,0x75,0x35,0x35,0x35,0x57,0x17,0x79,0x53,0x77,0x33,0x33,0x55,0x97,0x75,0x57,0x95,0x55,0x53,0x39,0x77,0x35,0x55,0x73,0x77,0x53,0x55,0x71,0x73,0x73,0x55,0x57,0x35,0x57,0x53,0x57,0x37,0x55,0x73,0x95,0x31,0x33,0x91,0x37,0x75,0x53,0x55,0x13,0x35,0x33,0x75,0x77,0x33,0x17,0x55,0x57,0x53,0x71,0x51,0x53,0x75,0x55,0x37,0x57,0x59,0x73,0x71,0x53,0x37,0x55,0x77,0x35,0x53,0x15,0x79,0x35,0x33,0x57,0x71,0x7,0x41,0x9f,0x77,0x7f,0xdb,0xb7,0x2d,0xbd,0xbe,0x25,0x27,0x5f,0x99,0x83,0x7a,0x76,0xee,0xf7,0x16,0x9e,0x20,0x76,0x98,0xb1,0xba,0xf8,0xe2,0x63,0x78,0xdf,0xd1,0x49,0x49,0x40,0x98,0x95,0xac,0x31,0xa2,0x99,0x2,0x39,0xb4,0xbd,0xe7,0xde,0x65,0xb1,0xfc,0xc,0x65,0x6b,0x1e,0xc7,0x1e,0x9b,0x75,0xf6,0x35,0x7,0x5e,0x1c,0xb4,0x83,0x37,0x61,0x3b,0xbc,0x4a,0x48,0xd7,0x98,0xd4,0xdb,0x18,0x30,0x6f,0x3d,0xec,0xb9,0xb3,0xde,0xc3,0xc7,0x86,0x28,0x70,0x4f,0x24,0xa7,0x8c,0x79,0xc6,0x16,0x58,0xe6,0xec,0xa8,0xb7,0xd7,0x68,0xf0,0x21,0xac,0x9a,0xee,0x33,0x64,0xa9,0x3b,0xfb,0x28,0xf8,0x3a,0x1f,0x99,0x99,0x7a,0x90,0x9f,0xe6,0x77,0x30,0x53,0x32,0xb5,0xcd,0xda,0xed,0x33,0x93,0x8,0x92,0x3b,0x9b,0xd3,0x21,0x7f,0x73,0x70,0xbf,0x9d,0x52,0x6a,0x47,0x3f,0xd8,0xf5,0x94,0x15,0x11,0x4,0x30,0xbe,0xc0,0x7,0xa6,0xec,0xeb,0x22,0x84,0x50,0xfc,0xe5,0x64,0x5c,0x28,0xb8,0xb5,0x57,0x36,0x3c,0x4b,0xaf,0xff,0x4f,0x90,0x93,0x72,0x7a,0xc3,0xa,0x30,0x91,0xd1,0x18,0x1,0xfb,0x9d,0x9f,0x26,0x41,0x50,0x2a,0x9e,0xc5,0xb8,0x35,0x3b,0x73,0xd5,0x2c,0xef,0x65,0x66,0x91,0xcc,0x6e,0x59,0xe2,0xc7,0x41,0xe0,0x57,0x77,0x66,0xa5,0x48,0x64,0xd3,0xd9,0xa3,0x7e,0xe,0x33,0x82,0x4f,0xcd,0x98,0xe5,0xea,0x39,0xdb,0x9,0xe2,0x1f,0x8a,0x53,0xcb,0xf6,0xee,0xfa,0x4d,0xdc,0x5f,0xd8,0xb6,0xa5,0x7,0xf7,0x37,0x2d,0x50,0x3b,0x8f,0xca,0x58,0x57,0x40,0x49,0x84,0xe6,0x5,0xaa,0xde,0xd5,0xf9,0x61,0xaf,0x79,0xd2,0xdb,0xcb,0xe5,0x7d,0x86,0x6,0xa0,0xb9,0xa6,0x9c,0xe3,0xcc,0x3e,0x37,0xba,0x55,0xad,0xc0,0x6a,0x47,0x72,0x8,0x87,0xa7,0xf5,0xcd,0xd4,0x9c,0x20,0x62,0xda,0x98,0x9c,0x13,0x15,0x93,0x32,0xd0,0x15,0x3d,0xcf,0xbf,0x6a,0x9d,0x94,0x7e,0x2d,0xcd,0xec,0xe3,0xec,0x88,0x7d,0x2e,0xee,0x4b,0xb5,0x6f,0xe3,0x91,0xab,0xa8,0xdb,0xf8,0x6d,0x8b,0x6a,0x5,0x7a,0x77,0xa3,0xc7,0x69,0xc3,0xce,0xcc,0x1f,0xa8,0x10,0x7c,0x95,0xc8,0x23,0x33,0xaa,0x1d,0x66,0x2c,0x30,0x37,0xf6,0x29,0x7f,0xf2,0xa5,0x2f,0xbf,0xc,0x4e,0xb1,0x38,0x4,0x18,0x79,0xa5,0x67,0x42,0xb3,0xf8,0xdd,0xa3,0x43,0xdb,0x34,0xde,0x3,0xe1,0x8e,0xb2,0xe1,0x6b,0xcf,0xdc,0x79,0xd0,0x63,0x1f,0x12,0xd7,0x77,0x85,0x1e,0xf,0xcb,0xa0,0x33,0x4b,0xea,0x3c,0xe,0x7e,0x68,0xff,0x76,0xc7,0x49,0x2c,0x57,0x8,0x56,0x72,0x1d,0xc0,0x41,0x72,0x91,0x75,0x84,0xe8,0xf1,0x7b,0xf9,0xbb,0x7b,0x7a,0xab,0x5f,0x83,0x8f,0x88,0x91,0x2f,0x50,0x59,0x8,0xaa,0x9d,0x7e,0x4f,0x8e,0x24,0x4b,0xde,0x3e,0x76,0x7c,0x91,0x9,0x11,0x2d,0x6c,0xbf,0x2d,0xdf,0x8a,0x5b,0xe8,0x85,0x83,0x55,0x3,0x9d,0xe9,0x39,0x53,0x8b,0xeb,0x19,0x54,0x79,0x23,0x2a,0x61,0x32,0x74,0x6b,0x35,0xb7,0xda,0xf8,0xc7,0x14,0xac,0xb9,0x4a,0x54,0xd2,0x1a,0x47,0x23,0x1,0xe,0xf5,0xa5,0xf1,0x2,0x70,0xa2,0xb3,0x6c,0x72,0x25,0x29,0x2d,0xe2,0xdf,0x78,0xa0,0x4e,0x5e,0x5b,0x8b,0xb0,0xb9,0xb2,0xff,0xb8,0xbe,0x17,0xca,0x23,0xda,0xad,0xe2,0x72,0xd4,0x6b,0x9e,0x90,0xf7,0x36,0xe6,0xcb,0x58,0x43,0x71,0xf1,0x54,0x4a,0x66,0x22,0x29,0x93,0x56,0x7b,0x59,0x33,0xd4,0x62,0x77,0x2b,0xa4,0x90,0xbf,0x55,0xdf,0x5e,0xe1,0xd8,0x5d,0xb0,0x37,0xf2,0x65,0xe6,0xac,0x3b,0x44,0x56,0xec,0x8f,0xa1,0x3f,0x32,0x7f,0xd3,0x6f,0xc3,0x76,0x1b,0x76,0x62,0x53,0xde,0x82,0xff,0xee,0xc8,0xc6,0x29,0x2a,0xdb,0xa1,0x1f,0x27,0xd6,0x99,0x4a,0x81,0x2c,0xcc,0x5c,0x16,0x90,0xec,0x30,0xc1,0x8d,0xb2,0xaa,0xd8,0x1c,0x43,0xd3,0xcf,0xe1,0x1d,0xdb,0xf4,0x33,0x82,0xcf,0x98,0x20,0xce,0xba,0x5f,0x88,0xc4,0xa,0x2,0x94,0xb5,0x42,0xd9,0xa9,0xd9,0xe8,0xaf,0x7e,0x73,0xd5,0x9e,0xc5,0x7b,0x28,0x27,0xfb,0xe9,0xb3,0x5b,0x57,0xca,0xb2,0x2b,0xf3,0x6b,0x95,0xf0,0xae,0x8e,0x6b,0x7f,0xde,0x8e,0x8f,0x5a,0xb6,0xae,0xd1,0xc8,0x9e,0x0,0xb7,0xc4,0x10,0x63,0xf9,0x3e,0x2e,0x6,0x7c,0xc8,0xe4,0xaf,0xc2,0xa9,0x71,0xf3,0x76,0x55,0x6d,0xdd,0x6e,0xd8,0x9e,0x12,0xd9,0xc1,0x7c,0xc4,0x2b,0xe4,0xb3,0xbc,0xa,0xe,0x7c,0x24,0x1,0xaf,0xfa,0xe7,0xb8,0xd2,0x50,0x8d,0x91,0x2a,0x8,0x65,0x2c,0x54,0xd2,0xc6,0x1d,0xe6,0x99,0xa2,0xf6,0x79,0xbf,0x86,0x55,0x90,0xb4,0x35,0x7e,0xa6,0xc,0xeb,0x2b,0x9b,0x8c,0x56,0xaa,0x79,0x6f,0xce,0x37,0x32,0x58,0x24,0x6b,0x95,0xae,0xae,0x5e,0x87,0xec,0x5f,0x88,0x32,0x75,0x15,0x11,0x82,0xe5,0xad,0x3a,0x1d,0xc7,0x73,0xc8,0xaf,0x74,0x9a,0x54,0x68,0x49,0x79,0xab,0x4d,0xa1,0xe8,0xe8,0xf2,0xe8,0xdd,0x95,0x8e,0x74,0xb,0x87,0xbf,0xe9,0x17,0x44,0x4c,0xf6,0xd8,0x82,0xa1,0x56,0x5e,0x5f,0x95,0x3f,0x39,0x71,0xe2,0xbc,0x37,0xcd,0xad,0x4,0xa9,0xe9,0xaf,0x8f,0x2a,0xc7,0x91,0xd1,0x57,0x42,0xb0,0xbf,0x40,0x9f,0x60,0xed,0x7a,0x4e,0x4a,0x34,0x90,0xf4,0x17,0x12,0x26,0xd4,0xbf,0x90,0x18,0xf8,0xf2,0x70,0x39,0xcc,0xbc,0x6b,0x37,0xc5,0xaa,0x5,0xbf,0x9f,0x8e,0xd8,0xc6,0xe8,0xfe,0x7a,0x83,0x92,0x3a,0xbe,0x5a,0x42,0xf1,0xdd,0xea,0xac,0x5f,0xe5,0x58,0x33,0x7f,0x91,0xf2,0x17,0x4,0xa3,0x94,0xea,0xc9,0xbe,0x4a,0xe2,0x55,0xca,0xa7,0x91,0xf,0x4e,0x90,0x9c,0xba,0xa5,0x97,0x9e,0xb3,0xf5,0x8b,0x5b,0x71,0xed,0x97,0xd0,0x2e,0x7b,0x55,0xa3,0x42,0xf6,0x49,0x38,0xf5,0x45,0xf0,0x44,0x30,0x2d,0xb6,0x27,0xfe,0x33,0x7a,0x6e,0x92,0x90,0xbc,0xad,0x18,0xb5,0xda,0x5f,0x1f,0x51,0x92,0x3c,0xbe,0xfa,0x2f,0x3b,0xc2,0x8,0x38,0xc4,0xa8,0xd7,0x5,0xb0,0x31,0xeb,0x8c,0xbc,0xea,0x38,0xcf,0xda,0x30,0xc1,0xbf,0xbd,0x3f,0xe1,0x15,0xb6,0xff,0x52,0x78,0x82,0xce,0xde,0x49,0x3a,0xb5,0x7a,0x6f,0x14,0x8b,0x7a,0xff,0x69,0xf2,0xef,0x8d,0x3c,0x37,0x78,0x36,0x94,0xa8,0xd1,0xc0,0xd,0x87,0x90,0x88,0x74,0x74,0xb2,0xc2,0x3,0x29,0xb2,0x90,0x4c,0x91,0xea,0xf,0xd5,0xa3,0xd3,0x7c,0x53,0x9,0x69,0xb6,0xcb,0xdf,0xd9,0x7,0x34,0x95,0xa8,0xd1,0x25,0x2f,0x28,0xcb,0xb4,0xbc,0x9,0xea,0x9b,0xe8,0x65,0x37,0x7,0xb5,0xf0,0x80,0x16,0xf0,0xa0,0xa6,0xa5,0x1d,0x73,0xd8,0xe5,0xef,0x89,0xf,0x79,0xc7,0x7e,0x36,0xf7,0x8a,0x8a,0xc2,0xef,0x7a,0x23,0xfd,0xcb,0x87,0x1d,0x78,0x52,0xb5,0x5e,0xf7,0x86,0x47,0xc8,0xcb,0x1,0x58,0xa6,0xb2,0x8d,0x94,0x79,0x60,0xe,0xe0,0xe7,0x5e,0x1c,0xdb,0x16,0xb2,0x5c,0x98,0x97,0x33,0x73,0x91,0xc0,0xa,0xce,0xb5,0x94,0x8f,0x99,0x9c,0x5e,0x26,0xba,0xbd,0x68,0xa0,0xb0,0x6f,0x8b,0x2a,0x4f,0x8c,0x45,0xa9,0xa8,0xbc,0x55,0xf6,0xbb,0x95,0xbf,0x2e,0xc0,0x8b,0x6,0xc,0x80,0xa0,0x42,0xaa,0x41,0x5f,0x8d,0x22,0xee,0x1,0xb1,0x3d,0xb2,0x51,0x7,0x86,0x5e,0x26,0x31,0xc1,0x1a,0x26,0x19,0x33,0x3b,0x2b,0x90,0xcf,0xc7,0x48,0xe6,0x3e,0x96,0x48,0xa9,0xb3,0x5a,0xa8,0xb4,0x70,0xc6,0xad,};
  unsigned char ct[FPTRU_KEM_CIPHERTEXTBYTES] = {0};

  for (i = 0; i < NTESTS; i++)
  {
    //crypto_kem_keygen(pk, sk);
    crypto_kem_encaps(ct, k1, pk);

    for(int i=0;i<FPTRU_KEM_CIPHERTEXTBYTES;i++){
            printf("0x%x,",ct[i]);
        }
        printf("\n\n");

        printf("result k1\n");
        for(int i=0;i<FPTRU_SHAREDKEYBYTES;i++){
            printf("0x%x,",k1[i]);
        }
        printf("\n\n");


    crypto_kem_decaps(k2, ct, sk);

    // printf("result k2\n");
    //     for(int i=0;i<FPTRU_SHAREDKEYBYTES;i++){
    //         printf("0x%x,",k2[i]);
    //     }
    //     printf("\n\n");

    for (j = 0; j < FPTRU_SHAREDKEYBYTES; j++)
      if (k1[j] != k2[j])
      {
        printf("Round %d. Failure: Keys dont match: %hhx != %hhx!\n", i, k1[j], k2[j]);
        return;
      }
  }

  printf("FPTRU-%d-KEM is correct!\n", FPTRU_N);

  printf("Test %d times.\n\n", NTESTS);
  printf("FPTRU_N = %d, FPTRU_Q = %d, FPTRU_Q2 = %d\n", FPTRU_N, FPTRU_Q, FPTRU_Q2);
  printf("KEM size: pk = %d bytes, ct = %d bytes, bandwidth = %d bytes\n\n",
         FPTRU_KEM_PUBLICKEYBYTES, FPTRU_KEM_CIPHERTEXTBYTES,
         FPTRU_KEM_PUBLICKEYBYTES + FPTRU_KEM_CIPHERTEXTBYTES);
}
//int16_t coes1[FPTRU_N] = {163,112,338,590,221,381,1017,571,762,419,278,571,776,693,785,0,58,337,47,361,36,633,44,891,46,105,796,527,929,178,328,102,953,886,313,909,219,382,336,825,92,1021,278,377,744,312,316,695,294,251,138,653,860,308,681,407,456,304,231,44,205,527,459,143,602,301,321,305,875,277,392,797,1021,76,367,267,577,379,260,158,614,711,899,573,409,291,218,288,647,396,302,970,737,439,486,80,954,1013,906,472,639,708,332,520,555,868,29,967,244,998,793,652,271,75,396,454,141,97,986,40,693,352,404,528,162,1008,489,591,256,283,301,397,590,158,56,397,976,321,223,782,725,454,853,181,307,264,160,266,17,368,333,630,483,842,380,931,447,410,438,235,251,979,1018,670,632,463,177,544,787,156,823,791,459,731,909,894,687,748,491,220,288,710,728,775,490,1005,104,937,783,145,47,454,9,162,78,834,908,70,97,248,74,678,51,183,787,526,557,613,261,501,478,60,9,220,124,633,27,467,585,586,99,821,175,883,791,786,352,434,717,444,146,1020,55,299,626,839,340,498,513,743,877,882,299,586,451,952,238,231,905,637,612,196,582,107,262,74,614,332,380,16,493,205,968,556,2,629,514,942,23,890,840,742,977,860,255,152,345,609,940,560,633,50,843,357,558,632,555,75,710,953,962,542,224,147,94,382,1004,712,989,383,105,638,345,899,892,24,735,298,21,32,846,389,675,410,950,757,635,206,831,1003,384,870,787,329,493,736,408,46,750,639,409,956,244,250,734,815,497,117,730,114,16,462,676,7,786,655,324,768,693,229,892,520,768,108,414,751,269,486,88,392,324,534,639,800,349,964,590,656,574,863,601,783,315,499,229,925,136,657,901,1022,545,193,12,634,129,757,490,537,44,614,770,881,312,601,27,810,983,704,616,28,489,683,268,742,570,31,674,80,573,668,279,780,639,590,913,736,796,104,1014,411,296,93,7,532,832,764,464,724,801,127,626,598,310,576,144,617,390,163,544,353,498,841,976,387,870,252,946,242,694,203,702,544,378,8,747,370,701,641,927,1007,646,165,720,887,28,520,720,942,889,156,794,66,260,189,1005,85,23,84,869,86,526,364,111,756,400,94,612,943,549,47,667,958,301,969,706,200,763,105,920,970,1004,769,708,231,12,483,502,246,635,556,601,74,311,138,461,883,481,836,769,578,864,757,777,214,456,776,822,421,207,871,470,147,814,365,704,318,525,843,801,555,502,433,897,294,390,34,958,68,48,969,1011,382,463,107,71,794,825,549,829,864,1001,561,39,420,987,170,176,383,830,167,136,495,733,288,779,630,126,987,658,591,408,153,862,781,248,652,342,379,354,964,899,196,316,324,144,246,380,248,240,186,358,191,728,1,246,507,282,1016,727,621,963,385,783,61,339,406,682,40,954,196,830,29,449,698,56,535,131,382,102,885,930,273,223,884,52,560,922,538,907,36,863,589,425,674,771,981,572,43,457,848,851,908,950,997,815,770,894,587,692,840,500,377,558,251,970,907,205,886,524,101,412,406,479,284,483,854,834,1014,992,299,624,145,937,912,199,323,61,395,193,759,241,221,865,312,617,14,218,347,951,891,402,352,431,505,557,277,793,502,343,835,687,1004,850,770,374,774,86,443,651,1005,787,956,474,531,443,131,34,93,620,353,826,73,311,641,618,908,672,106,163,27,713,772,210,464,283,561,200,39,951,468,883,548,871,889,529,357,931,912,649,99,1019,128,671,94,70,229,180,346,335,302,803,810,633,334,32,735,425,113,631,747,206,46,562,643,792,526,564,191,254,408,521,465,894,108,427,782,663,376,725,966,276,578,154,39,369,830,752,179,176,876,1018,879,282,118,342,617,828,582,648,372,427,295,850,70,622,445,908,112,78,795,26,567,301,216,326,617,825,330,69,282,974,627,31,522,516,200,68,249,852,438,811,420,624,366,344,57,758,180,221,890,486,243,987,535,703,577,362,978,309,958,610,496,677,412,652,376,415,772,397,140,896,346,35,749,61,799,567,102,959,299,7,254,242,501,160,375,844,953,715,1009,130,381,289,165,730,107,481,494,222,61,959,550,825,72,479,46,6,391,671,276,210,511,911,581,581,342,386,170,998,466,663,866,584,136,350,431,869,942,448,921,213,946,933,263,355,984,774,209,189,314,164,857,43,1016,71,864,662,477,999,355,76,398,696,356,375,574,428,726,646,393,482,575,823,808,894,993,767,761,204,645,392,61,390,195,93,690,206,210,693,581,617,91,9,165,61,219,652,918,269,572,404,588,135,439,691,867,692,1007,138,64,410,81,713,585,332,320,524,35,469,829,536,818,448,409,749,434,806,575,568,649,375,980,144,471,916,684,1006,376,792,215,479,452,84,604,825,994,915,266,772,932,620,511,490,859,543,835,144,865,37,208,99,795,131,721,513,86,636,592,638,757,863,377,735,563,536,935,208,1015,627,980,1010,889,997,186,747,395,350,418,726,119,120,905,214,678,874,243,174,930,232,792,298,72,621,456,506,646,259,549,323,364,944,206,910,31,184,552,568,355,248,140,625,827,515,475,18,864,630,42,730,650,662,311,476,710,658,447,255,583,99,320,611,355,282,663,639,133,54,918,124,280,411,390,871,141,394,541,349,162,82,427,984,214,576,268,697,987,815,645,882,935,52,357,540,575,697,68,51,365,192,352,124,671,554,251,321,508,625,28,881,455,982,882,251,885,669,913,782,455,991,80,32,708,191,319,495,317,455,832,362,353,649,836,99,278,669,448,973,196,609,78,88,897,613,582,926,700,157,218,332,41,202,565,93,540,379,603,70,253,708,736,275,763,550,675,364,811,610,79,549,293,13,195,933,680,711,948,715,876,791,292,232,450,1010,774,48,87,549,250,136,906,97,402,644,0,16,0,0,};
//int16_t coes2[FPTRU_N] = {-3,-2,2,0,4,2,0,0,0,0,0,0,2,2,0,-2,-2,2,0,-4,2,4,0,-4,0,4,-4,2,-4,0,-2,0,2,0,0,-2,2,2,0,0,-2,-4,2,0,-4,0,0,-2,-2,0,-2,-2,0,0,-4,2,-2,-4,-4,2,-4,2,0,2,0,4,-2,0,2,-2,0,0,-2,0,0,0,0,-2,4,4,-2,0,0,2,-2,0,2,0,-4,0,2,4,-2,2,-2,2,-2,0,0,0,2,-2,2,-2,0,0,2,0,0,0,0,0,2,-2,0,-2,2,0,4,-2,-2,-4,0,4,-2,-2,0,-2,-2,-4,-2,4,2,-2,2,0,4,2,2,0,2,0,0,2,-2,-2,-2,0,4,2,4,0,0,0,-2,-2,2,0,0,2,-2,-2,2,2,2,0,-2,0,-2,2,-2,0,-2,2,4,0,0,4,0,2,-2,2,0,-4,0,0,0,-2,2,0,0,-2,0,0,0,2,4,-2,0,2,-4,-4,2,0,-2,2,-4,0,-4,2,0,0,0,-4,0,-2,0,4,0,0,0,4,0,-2,0,0,2,2,-2,0,2,-2,-2,0,0,0,0,-2,-2,-2,-2,0,0,0,0,0,4,-2,0,0,0,2,2,-4,4,-2,-2,0,0,0,0,2,2,4,0,0,0,0,2,-2,4,4,-4,4,4,0,0,-2,2,2,-2,-2,0,2,2,-2,-2,-2,0,2,2,2,0,0,4,-2,4,0,0,2,-4,-2,0,0,0,0,0,-2,0,2,-4,2,0,0,0,0,2,2,-4,0,2,-2,0,0,0,-2,0,0,-2,0,2,0,-2,2,0,-4,2,0,-2,4,2,-2,0,-2,0,2,0,2,0,2,2,4,2,4,2,2,0,2,0,2,-2,-2,-2,2,-2,-2,0,0,2,2,-2,2,0,2,0,4,2,0,0,-2,4,0,0,-2,2,0,0,-2,0,2,2,4,2,2,-2,2,0,4,-2,2,0,4,-2,0,0,2,-2,-2,-2,-2,0,-2,0,-4,-2,0,0,-2,-2,2,0,0,0,2,-2,0,-2,-4,0,-2,0,2,-2,2,0,-2,0,0,2,2,-2,-2,0,2,0,0,0,-2,-2,0,-2,2,-2,-2,0,2,0,0,-4,0,0,0,0,0,0,0,-2,-2,0,-2,0,2,-2,2,0,-2,4,0,2,0,4,0,-2,2,-4,0,2,-2,2,-4,0,-4,-4,0,-2,-2,2,-2,-2,-2,0,0,0,2,2,2,-4,0,0,0,-4,-2,0,-2,0,0,0,-2,0,-2,0,0,2,2,-2,-4,0,-4,0,0,-2,-2,4,-4,0,0,0,2,0,0,0,0,-2,2,-2,2,0,0,2,-2,2,-2,-4,0,2,0,0,2,0,4,0,0,0,2,2,0,0,0,0,2,-2,-2,4,2,0,4,-2,-4,-2,0,2,0,-2,0,2,4,-2,0,-2,-2,2,0,2,2,0,2,4,4,0,-2,-2,2,2,-2,0,2,-2,2,0,2,-4,0,0,4,0,0,0,2,0,-2,-2,2,2,-4,0,0,0,4,0,0,0,4,0,2,-2,0,-2,2,0,-2,0,2,2,2,0,2,2,0,0,0,-2,0,-2,-2,2,0,2,0,0,0,0,-2,0,0,0,-2,2,0,4,2,0,0,2,0,-4,0,2,0,0,0,0,0,-2,2,0,-2,4,0,-2,2,2,0,0,2,2,2,-4,2,2,2,0,2,0,0,0,-2,0,4,-2,4,-4,2,-2,2,2,2,-2,2,2,2,0,2,-4,2,2,2,2,-2,0,2,0,0,0,0,-2,2,-2,-2,0,-2,-2,-2,0,0,4,4,-4,0,-2,4,-2,0,0,2,0,2,0,4,-2,2,2,2,4,4,2,0,0,0,0,0,4,2,2,-2,-2,0,0,-2,4,2,0,-4,2,-2,2,-2,-4,-4,2,0,-2,2,0,0,0,-2,0,2,0,0,0,0,0,2,-4,2,0,-2,2,0,-2,2,-2,-2,0,0,-2,2,2,-2,0,4,0,0,-4,-4,2,-2,0,-2,-2,0,0,-2,0,-4,2,-2,-2,0,2,-2,2,2,0,-4,2,2,0,0,0,-2,0,2,2,0,0,0,0,2,2,2,-2,-2,2,2,0,-2,0,0,2,2,2,0,2,0,2,-4,4,4,2,2,-2,0,4,4,0,0,0,2,-2,2,0,0,2,2,-2,0,-4,2,0,0,0,2,0,-2,0,-2,2,-4,0,-2,0,2,-4,-2,-2,0,-2,-2,-2,0,-4,0,0,0,-4,0,-2,0,-2,2,2,0,-2,0,0,-4,-2,2,0,0,0,0,0,-4,0,0,0,-2,-2,0,0,0,2,0,-2,0,0,0,2,0,0,4,-2,4,4,-2,0,2,-2,2,2,-2,2,0,-2,0,2,0,2,-4,-2,-2,-2,-4,0,-4,2,2,2,0,0,0,0,-2,0,-4,0,-2,4,0,0,-2,2,-4,0,2,0,0,-2,2,0,-2,-2,4,-2,-4,-2,-2,0,0,-4,-2,0,-2,-2,0,0,2,0,2,4,2,2,0,-2,2,0,0,0,0,2,-2,0,-2,0,0,-2,2,0,2,0,2,2,0,-2,2,-2,-2,0,-2,0,-2,0,0,0,0,0,0,0,0,4,0,-2,2,2,0,-4,0,-2,-2,0,0,0,0,-2,2,2,-4,0,2,0,4,2,0,-2,-4,2,0,2,-2,0,2,-2,-2,0,2,0,-2,0,-4,0,-2,-2,2,4,0,-4,2,0,-4,0,-2,-2,0,0,-4,-2,0,2,-4,0,0,0,2,2,0,-2,0,2,2,-4,2,2,-2,-2,0,0,2,-2,2,-2,4,2,-2,2,0,4,-2,0,0,0,0,2,-2,-2,-4,0,0,0,-2,2,2,2,-2,2,0,0,4,0,0,2,-2,0,-2,-2,2,-2,2,2,-4,2,4,2,4,4,0,2,-4,0,-2,0,-2,0,-2,4,-4,2,2,-4,-4,0,-4,0,2,0,-4,-2,0,0,0,0,0,-4,2,0,-4,0,2,0,0,-2,4,2,2,0,0,-2,-4,-4,0,2,4,0,0,0,0,2,0,-4,0,0,2,-2,4,0,0,-2,2,-2,-4,0,0,0,-2,-2,-2,0,2,-4,-2,-2,2,2,2,4,};
// void test_ntt(){
//   printf("start ntt\n");
//   poly a,b,c;
//   for(int i=0;i<FPTRU_N;i++){
//     a.coeffs[i]=coes1[i];
//     b.coeffs[i]=coes2[i];
//   }
//   poly_mul_q2(&c,&a,&b);
//   for(int i=0;i<FPTRU_N;i++){
//     printf("%d,",c.coeffs[i]);
//   }
//   printf("\n");
// }
int main()
{
  //test_ntt();
  test_kem();
  return 0;
}
